add FSMC; DMA fixes and speedup